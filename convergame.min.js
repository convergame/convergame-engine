function Convergame(t){this.canvas=t,this.ctx=this.canvas.getContext("2d");this.scene=null,this.controlsMap={},this.loadedImages={},this.then=null,this.sanityCheck=function(){return"object"!=typeof this.scene?!1:!0},this.mainGameLoop=function(){var t=Date.now(),e=t-this.then,i=e/1e3;this.scene.updateFunction(i),this.scene.renderFunction(),this.then=t,this.controlsPressed=[],requestAnimationFrame(this.mainGameLoop.bind(this))},this.startMainGameLoop=function(){this.sanityCheck()&&(this.then=Date.now(),this.mainGameLoop())},this.getCanvasWidth=function(){return t.width},this.getCanvasHeight=function(){return t.height},this.setCanvasTo16By9Ratio=function(){for(t.width=window.innerWidth,t.height=.5625*t.width;t.width>=window.innerWidth||t.height>=window.innerHeight;)t.width-=1,t.height-=1},this.getControlNameFromKeyCode=function(t){var e=null;switch(t){case 37:case 65:e="left";break;case 38:case 87:e="up";break;case 39:case 68:e="right";break;case 40:case 83:e="down";break;case 13:e="enter";break;case 32:e="space"}return e},this.isControlPressed=function(t){return void 0===this.controlsMap[t]?!1:this.controlsMap[t]},this.drawImage=function(t,e,i,n,s){if(void 0!==this.loadedImages[t])this.ctx.drawImage(this.loadedImages[t],e*this.getXScale(),i*this.getYScale(),n*this.getXScale(),s*this.getYScale());else{var a=new Image,h=this;a.onload=function(){h.loadedImages[t]=a},a.src=t}},this.drawCircle=function(t,e,i,n){this.ctx.strokeStyle=n,this.ctx.beginPath(),this.ctx.arc(t*this.getXScale(),e*this.getYScale(),i*this.getXScale(),0,2*Math.PI),this.ctx.stroke()},this.drawFilledCircle=function(t,e,i,n,s){this.ctx.strokeStyle=n,this.ctx.fillStyle=s,this.ctx.beginPath(),this.ctx.arc(t*this.getXScale(),e*this.getYScale(),i*this.getXScale(),0,2*Math.PI),this.ctx.stroke(),this.ctx.fill()},this.drawRect=function(t,e,i,n,s){this.ctx.strokeStyle=s,this.ctx.strokeRect(t*this.getXScale(),e*this.getYScale(),i*this.getXScale(),n*this.getYScale())},this.drawFilledRect=function(t,e,i,n,s,a){this.ctx.strokeStyle=s,this.ctx.fillStyle=a,this.ctx.fillRect(t*this.getXScale(),e*this.getYScale(),i*this.getXScale(),n*this.getYScale())},this.drawText=function(t,e,i,n,s,a,h,o,c,r,l){o=void 0!==o?o:!1,this.ctx.font=n*this.getXScale()+"px "+s,this.ctx.textAlign=a,o===!0&&(this.ctx.fillStyle=l,this.ctx.fillText(h,(t+c)*this.getXScale(),(e+r)*this.getYScale())),this.ctx.fillStyle=i,this.ctx.fillText(h,t*this.getXScale(),e*this.getYScale())},this.getTextWidth=function(t){var e=this.ctx.measureText(t);return e.width},this.getTextHeight=function(t){var e=this.ctx.measureText(t);return e.height},this.blankCanvas=function(t){this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.getCanvasWidth(),this.getCanvasHeight())},this.init=function(){this.setCanvasTo16By9Ratio(),document.getElementById("body").style.padding="0",document.getElementById("body").style.margin="0",window.addEventListener("resize",function(){this.setCanvasTo16By9Ratio()}.bind(this)),window.addEventListener("keydown",function(t){var e=this.getControlNameFromKeyCode(t.keyCode);this.controlsMap[e]=!0,[32,37,38,39,40].indexOf(t.keyCode)>-1&&t.preventDefault()}.bind(this)),window.addEventListener("keyup",function(t){var e=this.getControlNameFromKeyCode(t.keyCode);this.controlsMap[e]=!1}.bind(this)),this.canvas.ondragstart=function(t){return t&&t.preventDefault?t.preventDefault():t&&t.stopPropagation&&t.stopPropagation(),!1},this.canvas.onselectstart=function(t){return t&&t.preventDefault?t.preventDefault():t&&t.stopPropagation&&t.stopPropagation(),!1}},this.fullscreen=function(){t.requestFullScreen?t.requestFullScreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():alert("Fullscreen not supported by your browser.")},this.setPixelGame=function(t){t?(this.ctx.webkitImageSmoothingEnabled=!1,this.ctx.mozImageSmoothingEnabled=!1,this.ctx.imageSmoothingEnabled=!1):(this.ctx.webkitImageSmoothingEnabled=!0,this.ctx.mozImageSmoothingEnabled=!0,this.ctx.imageSmoothingEnabled=!0)},this.getXScale=function(){return convergame.getCanvasWidth()/1920},this.getYScale=function(){return convergame.getCanvasHeight()/1080},this.random=function(t,e){return Math.floor(Math.random()*(1+e-t))+t},this.isCollide=function(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y?!0:!1},this.changeScene=function(t){this.controlsMap={},this.scene=t,this.scene.init(this)},this.preShake=function(){ctx.save();var t=8*Math.random(),e=8*Math.random();ctx.translate(t,e)},this.postShake=function(){ctx.restore()}}var canvas=document.getElementById("game");